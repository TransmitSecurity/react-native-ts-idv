# React Native - Identity Verification

React Native module for Transmit Security Identity Verification SDK. Verify customersâ€™ identities during onboarding and beyond.

## About Identity Verification
Transmit Security Identity Verification SDK offers a comprehensive identity verification solution, utilizing deep document inspection, biometric matching, and rapid background checks to streamline customer enrollment, enhance compliance, expedite time to market, prevent fraud, and fortify security within a seamless CIAM platform. 

Using this module, you can easily integrate our Identity Verification SDK into your React Native app for seamless and secure user identity verification.<br>
[Learn more about how you can boost your security with Transmit Security Identity Verification.](https://transmitsecurity.com/platform/identity-verification)

## Understand the flow
We recommended that you read more about the verification flow required steps in our [documentation](https://developer.transmitsecurity.com/guides/verify/quick_start_ios/)

## Configure your app
To integrate this module, you'll need to configure an application.

1. From the [Applications](https://portal.transmitsecurity.io/applications) page, [create a new application](https://developer.transmitsecurity.com/guides/user/create_new_application/) or use an existing one.
2. From the application settings:
    * For Client type , select native
    * For Redirect URI , enter your website URL. This is a mandatory field, but it isn't used for this flow.
    * Obtain your client ID and secret for API calls, which are autogenerated upon app creation.

## Example project setup
1. In your project, navigate to `example/src/config.ts` and configure the clientId and secret using the credentials obtained from the Transmit portal.
2. Ensure you have all the necessary dependencies by running `yarn` in both the module's root folder and the example root folder.
3. Run the example app on a real device using Xcode or Android Studio. Alternatively, execute `yarn example ios` or `yarn example android`.

> **Important Security Note: Never store your `secret` in a front-end application.**
> 
> The example app utilizes a mock server to manage communication with the identity verification platform. This mock server employs the `secret` you have specified in `example/src/config.ts` exclusively for demonstration purposes. It is paramount that you safeguard your `secret` in a secure and confidential location.

## Module installation
To install this module, execute the following command in your project's root folder.
```sh
npm install react-native-ts-idv
```

#### iOS Setup
You might need to execute `pod install` in your project's `/ios` folder.

#### Android Setup
Add to `app/build.gradle` under repositories

```gradle
maven {
    url('https://transmit.jfrog.io/artifactory/transmit-security-gradle-release-local/')
}
```

## Add camera permission
For module usage, configuring permissions for the device camera on both iOS and Android is necessary. You must also explicitly request user permission before commencing the identity verification process. See the `/example` project to learn more.

## Usage

#### Module Setup
```js
import IdentityVerification, { TSIDV } from 'react-native-ts-idv';
const { TsIdv } = NativeModules;
const eventEmitter = new NativeEventEmitter(TsIdv); // Create an event emitter with the native module TsIdv

private verificationStatusChangeSub?: EmitterSubscription; // Imported from react-native

componentDidMount(): void {
    // Setup the module as soon your component is ready
    this.onAppReady().catch(e => void e);
}

private onAppReady = async (): Promise<void> => {
    /* Initialize the module with parameters: 
        1. ClientID obtained from the application settings in the Transmit portal
        2. Optional: Base URL. Defaults to TSIDV.BaseURL.us
    */
    IdentityVerification.initialize(config.clientId, TSIDV.BaseURL.us);
    
    // Register to receive status updates
    this.verificationStatusChangeSub = eventEmitter.addListener(
      "idv_status_change_event", // Important! use this event name
      this.onVerificationStatusChange
    );
}

componentWillUnmount(): void {
    this.verificationStatusChangeSub?.remove(); // Remove the subscription when it's no longer needed
}
```

#### Start the verification process
```js
onStartVerificationProcess = async (): Promise<void> => {
    try {
        // See Step 7: Create session https://developer.transmitsecurity.com/guides/verify/quick_start_ios/ to get startToken
        const startToken = verificationSession.startToken; 
        await IdentityVerification.startIdentityVerification(startToken); // This will trigger the native SDK to start the flow
        console.log("Started identity verification process");
    } catch (error) {
        console.error(`Error verifying user identity: ${error}`);
    }
}
```

#### Handle status changes
```js
private onVerificationStatusChange = (params: any) => {
    const status = params["status"];
    const additionalData = params["additionalData"];

    switch (status) {
        case VerificationStatus.verificationDidCancel:
            console.log(`verificationDidCancel`);
            break;
        case VerificationStatus.verificationDidComplete:
            console.log(`verificationDidComplete`);
            break;
        case VerificationStatus.verificationDidFail:
            console.log(`verificationDidFail: ${error}`);
            break;
        case VerificationStatus.verificationDidStartCapturing:
            console.log(`verificationDidStartCapturing`);
            break;
        case VerificationStatus.verificationDidStartProcessing:
            console.log(`verificationDidStartProcessing`);
            break;
        case VerificationStatus.verificationRequiresRecapture:
            const reason: string = additionalData["error"];
            console.log(`verificationRequiresRecapture: ${reason}`);
            break;
        default:
            console.log(`Unhandled verification status: ${status}`);
    }
}

```

#### Obtaining verification results
Once the module emits the `verificationDidComplete` event, you can fetch the results from your server as described in [Step 10: Handle verification result](https://developer.transmitsecurity.com/guides/verify/quick_start_ios/#step-10-handle-verification-result) 

## Important Notes
1. Make sure to use `idv_status_change_event` for the emitter event name.
2. Please take note that the example application uses a client-side mock server. In a production environment, a real server is required. Additionally, it is crucial to emphasize that storing the client secret in your front-end application is strictly discouraged for security reasons.

## Support
[Email us for support](info@transmitsecurity.com)

## Author

Transmit Security, https://github.com/TransmitSecurity

## License

This project is licensed under the MIT license. See the LICENSE file for more info.
